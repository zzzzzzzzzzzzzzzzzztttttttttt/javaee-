<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>商品详情</title>
    <style>
        .detail-container { display: flex; padding: 20px; gap: 30px; }
        .goods-img { width: 400px; height: 400px; }
        .info-container { flex: 1; }
        .price { color: red; font-size: 24px; }
        .num-control { margin: 20px 0; }
        .btn-add { padding: 10px 20px; background: #ff4400; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
<div class="detail-container">
    <!-- 商品图片 -->
    <img th:src="${goods.goodsImg}" alt="商品图片" class="goods-img">

    <!-- 商品信息 -->
    <div class="info-container">
        <h1 th:text="${goods.goodsName}"></h1>
        <p class="price">¥<span th:text="${goods.price}"></span></p>
        <p>库存：<span th:text="${goods.stock}"></span>件</p>
        <p th:text="${goods.goodsDesc}"></p>

        <div class="num-control">
            <button onclick="changeNum(-1)">-</button>
            <input type="number" id="num" value="1" min="1" th:max="${goods.stock}">
            <button onclick="changeNum(1)">+</button>
        </div>

        <button class="btn-add" onclick="addCart(${goods.goodsId})">加入购物车</button>
    </div>
</div>

<script>
    function changeNum(step) {
        const input = document.getElementById('num');
        let num = parseInt(input.value) + step;
        input.value = Math.max(1, Math.min(num, parseInt(input.max)));
    }

    function addCart(goodsId) {
        const userId = 1; // 实际从登录会话获取
        const num = document.getElementById('num').value;
        fetch(`/cart/add?userId=${userId}&goodsId=${goodsId}&num=${num}`, {
            method: 'POST'
        }).then(res => res.text())
            .then(data => alert(data === 'success' ? '加入购物车成功' : '加入失败'));
    }
</script>
</body>
</html>